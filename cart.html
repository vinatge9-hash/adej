<!doctype html>
<!-- Google Font: 'Inter', 400,700 -->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Niyantri Coffee - Cart</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>
</head>
<body class="bg-gradient-to-br from-amber-100 to-amber-50 min-h-screen text-stone-900">
  <header class="w-full bg-amber-900 text-white">
    <nav class="flex items-center justify-between px-6 py-4">
      <a href="./index.html" class="text-2xl font-bold tracking-wide">Niyantri Coffee</a>
      <ul class="flex gap-6 font-medium">
        <li><a href="./index.html" class="hover:underline">Home</a></li>
        <li><a href="./menu.html" class="hover:underline">Menu</a></li>
        <li><a href="./cart.html" class="hover:underline">Cart</a></li>
        <li><a href="./about.html" class="hover:underline">About</a></li>
        <li><a href="./contact.html" class="hover:underline">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main class="w-full px-6 py-12">
    <section class="max-w-2xl mx-auto bg-white rounded-lg shadow p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Your Cart</h2>
      <div id="cart-items" class="space-y-2"></div>
      <div id="cart-empty" class="text-gray-600" style="display:none;">Your cart is empty. Add items from the Menu.</div>
      <div class="flex items-center justify-between mt-4 pt-4 border-t">
        <div class="text-lg font-semibold">Total: $<span id="cart-total">0.00</span></div>
        <a href="./menu.html" class="inline-block bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-500 transition">Continue Shopping</a>
      </div>
    </section>

    <section class="max-w-3xl mx-auto bg-white rounded-lg shadow p-6">
      <h3 class="text-xl font-semibold mb-3">Checkout</h3>
      <div id="paypal-button-container"></div>
      <p class="text-xs text-gray-500 mt-2">Note: This uses PayPal Sandbox. Replace client-id with a live one in production.</p>
    </section>
  </main>

  <footer class="w-full bg-amber-900 text-white py-6 mt-12">
    <div class="text-center text-sm">Â© 2025 Niyantri Coffee. All rights reserved.</div>
  </footer>

  <script>
    const format = (n) => Number(n).toFixed(2);
    const renderCart = () => {
      const cart = JSON.parse(localStorage.getItem('ny_cart') || '[]');
      const container = document.getElementById('cart-items');
      const empty = document.getElementById('cart-empty');
      container.innerHTML = '';
      if (!cart.length) {
        empty.style.display = 'block';
        document.getElementById('cart-total').innerText = '0.00';
        return;
      }
      empty.style.display = 'none';
      let total = 0;
      cart.forEach(item => {
        const line = document.createElement('div');
        line.className = 'flex items-center justify-between p-2 border rounded';
        const lineTotal = item.price * item.qty;
        total += lineTotal;
        line.innerHTML = `
          <div class="flex items-center gap-3">
            <span class="text-sm font-semibold">${item.name}</span>
            <span class="text-xs text-gray-500">x${item.qty}</span>
          </div>
          <span class="text-sm">$${format(lineTotal)}</span>
        `;
        container.appendChild(line);
      });
      document.getElementById('cart-total').innerText = format(total);
    };

    const addToCartFromItem = (id, name, price) => {
      let cart = JSON.parse(localStorage.getItem('ny_cart') || '[]');
      const existing = cart.find(i => i.id === id);
      if (existing) existing.qty += 1; else cart.push({ id, name, price, qty: 1 });
      localStorage.setItem('ny_cart', JSON.stringify(cart));
      renderCart();
    };

    // Init cart from menu on first load (for demo/demo data)
    window.addEventListener('DOMContentLoaded', () => {
      renderCart();
    });

    // PayPal Buttons
    const total = () => parseFloat(document.getElementById('cart-total').innerText || '0');
    // Render PayPal buttons after DOM loads
    window.addEventListener('load', () => {
      paypal.Buttons({
        createOrder: function(data, actions) {
          const value = total();
          return actions.order.create({"purchase_units":[{"amount":{"currency_code":"USD","value": value.toFixed(2)}}]});
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            alert('Payment completed. Thank you, ' + details.payer.name.given_name + '!');
            localStorage.removeItem('ny_cart');
            renderCart();
          });
        }
      }).render('#paypal-button-container');
    });
  </script>

  <script>
    // Simple global function to support menu.html's Add to Cart from this page (for demo)
    // Not strictly required since cart uses its own storage flow.
  </script>
</body>
</html>